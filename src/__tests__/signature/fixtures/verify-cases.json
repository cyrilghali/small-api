[
  {
    "name": "accept valid signature",
    "description": "Verify a payload with a valid HMAC-SHA256 signature returns 204 No Content",
    "data": {
      "message": "hello world"
    },
    "signature": "f7120f77ad7c741c5b17413d7dbb44413cea542c0b0ecae1751ff2caf23b195b",
    "secret": "my-secret-key",
    "expectedResult": true,
    "expectedStatus": 204
  },
  {
    "name": "reject invalid signature",
    "description": "Verify a payload with an invalid signature returns 400 Bad Request",
    "data": {
      "message": "hello world"
    },
    "signature": "0000000000000000000000000000000000000000000000000000000000000000",
    "secret": "my-secret-key",
    "expectedResult": false,
    "expectedStatus": 400
  },
  {
    "name": "reject signature with wrong secret",
    "description": "Verify with a different secret than used for signing returns 400 Bad Request",
    "data": {
      "user": "alice",
      "action": "transfer",
      "amount": 100
    },
    "signature": "ee3e567037651939d72312625d8f3eb6251ed0b3246e284bbf854ae06393cdfc",
    "secret": "wrong-secret",
    "expectedResult": false,
    "expectedStatus": 400
  },
  {
    "name": "verify multi-field payload (order-independent)",
    "description": "Verify a signed object with multiple fields (properties order-independent)",
    "data": {
      "user": "alice",
      "action": "transfer",
      "amount": 100
    },
    "signature": "ee3e567037651939d72312625d8f3eb6251ed0b3246e284bbf854ae06393cdfc",
    "secret": "secret123",
    "expectedResult": true,
    "expectedStatus": 204
  },
  {
    "name": "verify multi-field payload (order-independent) - part 2",
    "description": "Verify a signed object with multiple fields (properties order-independent)",
    "data": {
      "action": "transfer",
      "amount": 100,
      "user": "alice"
    },
    "signature": "ee3e567037651939d72312625d8f3eb6251ed0b3246e284bbf854ae06393cdfc",
    "secret": "secret123",
    "expectedResult": true,
    "expectedStatus": 204
  },
  {
    "name": "verify empty object",
    "description": "Verify a signed empty object",
    "data": {},
    "signature": "2029f511842e550e8e0511dce1ab883cfbe4531c0ad64cb5ce3eeb8997c47786",
    "secret": "empty-secret",
    "expectedResult": true,
    "expectedStatus": 204
  },
  {
    "name": "reject missing signature",
    "description": "Verify with missing signature field returns 400 Bad Request",
    "data": {
      "message": "hello world"
    },
    "signature": null,
    "secret": "my-secret-key",
    "expectedResult": false,
    "expectedStatus": 400
  },
  {
    "name": "reject modified payload",
    "description": "Verify returns 400 when payload has been modified after signing",
    "data": {
      "message": "hello world modified"
    },
    "signature": "f7120f77ad7c741c5b17413d7dbb44413cea542c0b0ecae1751ff2caf23b195b",
    "secret": "my-secret-key",
    "expectedResult": false,
    "expectedStatus": 400
  },
  {
    "name": "accept signature regardless of property order",
    "description": "Signature remains valid regardless of property order (canonical JSON)",
    "data": {
      "amount": 100,
      "action": "transfer",
      "user": "alice"
    },
    "signature": "ee3e567037651939d72312625d8f3eb6251ed0b3246e284bbf854ae06393cdfc",
    "secret": "secret123",
    "expectedResult": true,
    "expectedStatus": 204
  }
]
